<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>c2框架release_v1版本 | Red Team, Malware Development, Code Auditing, Focused on Cybersecurity,C2 Developer,Security Researcher</title><meta name="author" content="cc"><meta name="copyright" content="cc"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="c2框架release_v1版本c2_server 这是目前实现的功能 没有采用ui开发(问就是懒得学) c2_beaconbeacon实现的功能:  全程使用hash计算动态获取函数 避免导入表暴露使用的函数 同时避免通过LoadLibraryA和GetProcAddress获取到使用的函数  使用独特的睡眠技术反沙箱  使用硬件断点和各种高级反沙箱技术  固定时间重连服务端 防止服务端中断导致">
<meta property="og:type" content="article">
<meta property="og:title" content="c2框架release_v1版本">
<meta property="og:url" content="https://chao112122.github.io/2025/10/08/c2_release/index.html">
<meta property="og:site_name" content="Red Team, Malware Development, Code Auditing, Focused on Cybersecurity,C2 Developer,Security Researcher">
<meta property="og:description" content="c2框架release_v1版本c2_server 这是目前实现的功能 没有采用ui开发(问就是懒得学) c2_beaconbeacon实现的功能:  全程使用hash计算动态获取函数 避免导入表暴露使用的函数 同时避免通过LoadLibraryA和GetProcAddress获取到使用的函数  使用独特的睡眠技术反沙箱  使用硬件断点和各种高级反沙箱技术  固定时间重连服务端 防止服务端中断导致">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://chao112122.github.io/img/123.png">
<meta property="article:published_time" content="2025-10-08T06:40:18.048Z">
<meta property="article:modified_time" content="2025-10-08T09:05:39.554Z">
<meta property="article:author" content="cc">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://chao112122.github.io/img/123.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "c2框架release_v1版本",
  "url": "https://chao112122.github.io/2025/10/08/c2_release/",
  "image": "https://chao112122.github.io/img/123.png",
  "datePublished": "2025-10-08T06:40:18.048Z",
  "dateModified": "2025-10-08T09:05:39.554Z",
  "author": [
    {
      "@type": "Person",
      "name": "cc",
      "url": "https://chao112122.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/123.png"><link rel="canonical" href="https://chao112122.github.io/2025/10/08/c2_release/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'c2框架release_v1版本',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/123.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">14</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> archives</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> about</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Red Team, Malware Development, Code Auditing, Focused on Cybersecurity,C2 Developer,Security Researcher</span></a><a class="nav-page-title" href="/"><span class="site-name">c2框架release_v1版本</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> archives</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> about</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">c2框架release_v1版本<a class="post-edit-link" href="https://github.com/chao112122_posts/c2_release.md" title="编辑" target="_blank"><i class="fas fa-pencil-alt"></i></a></h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-10-08T06:40:18.048Z" title="发表于 2025-10-08 14:40:18">2025-10-08</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-10-08T09:05:39.554Z" title="更新于 2025-10-08 17:05:39">2025-10-08</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h2 id="c2框架release-v1版本"><a href="#c2框架release-v1版本" class="headerlink" title="c2框架release_v1版本"></a>c2框架release_v1版本</h2><h3 id="c2-server"><a href="#c2-server" class="headerlink" title="c2_server"></a>c2_server</h3><p><img src="/img/540db178c48c6771b052fe8c583efcf5.png" alt="540db178c48c6771b052fe8c583efcf5"></p>
<p>这是目前实现的功能 没有采用ui开发(问就是懒得学)</p>
<h3 id="c2-beacon"><a href="#c2-beacon" class="headerlink" title="c2_beacon"></a>c2_beacon</h3><h4 id="beacon实现的功能"><a href="#beacon实现的功能" class="headerlink" title="beacon实现的功能:"></a>beacon实现的功能:</h4><ul>
<li><input checked="" disabled="" type="checkbox"> 全程使用hash计算动态获取函数 避免导入表暴露使用的函数 同时避免通过LoadLibraryA和GetProcAddress获取到使用的函数</li>
<li><input checked="" disabled="" type="checkbox"> 使用独特的睡眠技术反沙箱</li>
<li><input checked="" disabled="" type="checkbox"> 使用硬件断点和各种高级反沙箱技术</li>
<li><input checked="" disabled="" type="checkbox"> 固定时间重连服务端 防止服务端中断导致beacon丢失</li>
<li><input checked="" disabled="" type="checkbox"> 使用高级睡眠混淆 防止内存扫描 可动态开启或者关闭</li>
<li><input checked="" disabled="" type="checkbox"> 字符串加密 防止通过string定位获得到关键信息</li>
<li><input checked="" disabled="" type="checkbox"> 随机睡眠时间外加时间抖动</li>
<li><input checked="" disabled="" type="checkbox"> 自实现常用的cmd命令 让beacon更加opsec</li>
<li><input checked="" disabled="" type="checkbox"> 流量混淆带全加密 防止EDR检测</li>
<li><input checked="" disabled="" type="checkbox"> 修复了网络通信问题 网络通信更加稳定</li>
<li><input checked="" disabled="" type="checkbox"> 处理了全局的网络异常问题</li>
<li><input checked="" disabled="" type="checkbox"> 添加了内存执行技术  让beacon更加opsec</li>
<li><input checked="" disabled="" type="checkbox"> 添加了三种注入技术</li>
<li><input checked="" disabled="" type="checkbox"> 添加了上传和下载功能</li>
<li><input checked="" disabled="" type="checkbox"> 添加了收集电脑常见信息的功能</li>
<li><input checked="" disabled="" type="checkbox"> 添加了截图功能</li>
<li><input checked="" disabled="" type="checkbox"> 添加了dump指定进程的功能</li>
<li><input checked="" disabled="" type="checkbox"> 添加了列出当前所有的进程的功能</li>
</ul>
<p><img src="/img/bafff3465f5932c933d4bdc11fa87fb1.png" alt="bafff3465f5932c933d4bdc11fa87fb1"></p>
<p>可单文件绕过360核晶执行命令</p>
<p><img src="/img/a408c7b35689d32a569d8ff4bef06a44.png" alt="a408c7b35689d32a569d8ff4bef06a44"></p>
<p>可单文件无感绕过defender执行命令</p>
<p><img src="/img/1bca3032021bc00946790d239c7d88b5.png" alt="1bca3032021bc00946790d239c7d88b5"></p>
<p>可单文件无感绕过火绒执行命令</p>
<p><img src="/img/8b531beebb469e22a209e49c39e6da15.png" alt="8b531beebb469e22a209e49c39e6da15"></p>
<p>可单文件无感绕过赛门铁克(老版本的 已经没什么杀毒能力)执行命令</p>
<p><img src="/img/c803af389aa5cfb3412870714dc3f04b.png" alt="c803af389aa5cfb3412870714dc3f04b"></p>
<p><img src="/img/e1a7db3dd8b478cf1b8b3c94da43a67b.png" alt="e1a7db3dd8b478cf1b8b3c94da43a67b"></p>
<p>可单文件无感绕过卡巴执行命令 扫描所有文件和进程也没报毒</p>
<p>可单文件过国内某EDR且执行命令 这里由于版权没有放出来 但执行bof会报毒 因为几乎所有的c2框架都是参考了cs的内存加载技术</p>
<p>都引入了beacon.h这个文件 导致出现特征 这个等后续重新实现一下或者自实现一个壳保护应该就能绕过 </p>
<p><img src="/img/b4161d0ce136b451deb2cc8b4af2e230.png" alt="b4161d0ce136b451deb2cc8b4af2e230"></p>
<p><img src="/img/82134bbf759ba6fa00a80c7ebd3ae221.png" alt="82134bbf759ba6fa00a80c7ebd3ae221"></p>
<p>beacon在ida的反编译情况</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://chao112122.github.io">cc</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://chao112122.github.io/2025/10/08/c2_release/">https://chao112122.github.io/2025/10/08/c2_release/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://chao112122.github.io" target="_blank">Red Team, Malware Development, Code Auditing, Focused on Cybersecurity,C2 Developer,Security Researcher</a>！</span></div></div><div class="tag_share"><div class="post-share"><div class="social-share" data-image="/img/123.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/11/12/mianshi/" title="面试经验"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">面试经验</div></div><div class="info-2"><div class="info-item-1">面试经验沥泉科技红队一面1.自我介绍及主要技术栈和熟悉的方向 2.如何信息收集? 3.了解过代码审计?说一下代码审计方面的 4.说一下java的各种协议以及如何利用 5.java的作用域 6.了解过php的代码审计? 7.说一下php的审计思路 8.php审计常见的漏洞函数 9,java的反序列化漏洞 这里问了都是关于java和php的代码审计相关的  因为已经很久没碰java安全了 基本全忘了…….代码审计也是很多之前审计的,….开局就一直懵……后面我主动提出 java安全和审计太久没接触忘记了…暂时跳过了这个话题 10.说一下Window的协议 11.域内怎么收集信息 12.在内网但不在域控内如何定位到域以及横向到域内 13.黄金和白银票据的区别 14,票据有哪些作用 15.你说你熟悉免杀是吧? 16.了解主流杀软吗 17.说一下常见杀软的绕过思路 18.核晶了解吗 怎么绕过核晶 19.白驱动攻击了解吗 原理是什么 20.白驱动攻击需要什么条件 21.核晶下怎么提权 22.说一下什么是apc 以及apc注入的原理 23.说一下反调试和反沙箱手法 24.有没有了解过一个前沿的免...</div></div></div></a><a class="pagination-related" href="/2025/09/25/code1/" title="记录一次代码审计"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">记录一次代码审计</div></div><div class="info-2"><div class="info-item-1">记录一次代码审计Rce找到seo控制器下的save方式 通过param方法传参 进入_set方法  Filename是seo 整个文件路径可预测 将param参数for出来 用file_put_contents写入 整个过程无过滤  任意文件上传导致rce来到图示方法下 根据要求传参   来到getimg方式 url参数可控  进入download函数  文件路径是上传日期和访问url的文件昵称(可预测) Url是我们远程开启的恶意文件 get_url_content会对传入url的内容进行获取(无过滤) **然后写入成功getshell    Ssrf 在刚才的get_url_content实际还存在ssrf Xss  文件上传允许svg文件导致xss 且数据包回显路径   任意文件删除**通过id传参拼接无过滤实现任意删除  **同样还有  还有任意目录删除 注意是删除整个目录下的文件  实在太多任意删除就不放了   *任意文件读取  **实际数据包后面报错的内容就是文件读取的内容  Sql注入 **!   </div></div></div></a></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/123.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">cc</div><div class="author-info-description">Redteam</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">14</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/chao112122"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">feel free to contact me at my Google email: jiah3540@gmail.com</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#c2%E6%A1%86%E6%9E%B6release-v1%E7%89%88%E6%9C%AC"><span class="toc-number">1.</span> <span class="toc-text">c2框架release_v1版本</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#c2-server"><span class="toc-number">1.1.</span> <span class="toc-text">c2_server</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#c2-beacon"><span class="toc-number">1.2.</span> <span class="toc-text">c2_beacon</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#beacon%E5%AE%9E%E7%8E%B0%E7%9A%84%E5%8A%9F%E8%83%BD"><span class="toc-number">1.2.1.</span> <span class="toc-text">beacon实现的功能:</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/11/12/mianshi/" title="面试经验">面试经验</a><time datetime="2025-11-12T01:29:39.303Z" title="发表于 2025-11-12 09:29:39">2025-11-12</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/10/08/c2_release/" title="c2框架release_v1版本">c2框架release_v1版本</a><time datetime="2025-10-08T06:40:18.048Z" title="发表于 2025-10-08 14:40:18">2025-10-08</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/25/code1/" title="记录一次代码审计">记录一次代码审计</a><time datetime="2025-09-24T23:12:46.220Z" title="发表于 2025-09-25 07:12:46">2025-09-25</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/25/dump/" title="全新视角下的 Java：一种全新的方式实现完美 dump lsass">全新视角下的 Java：一种全新的方式实现完美 dump lsass</a><time datetime="2025-09-24T23:11:29.825Z" title="发表于 2025-09-25 07:11:29">2025-09-25</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/25/java_dump/" title="全新视角下的 Java：一种非传统的免杀加载器轻松绕过杀软">全新视角下的 Java：一种非传统的免杀加载器轻松绕过杀软</a><time datetime="2025-09-24T23:00:58.498Z" title="发表于 2025-09-25 07:00:58">2025-09-25</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 By cc</span><span class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.4.3</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>